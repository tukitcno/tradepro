{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../components/AuthContext';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[identifier,setIdentifier]=useState('');const[otp,setOtp]=useState('');const[otpSent,setOtpSent]=useState(false);const[loading,setLoading]=useState(false);const{login,sendOTP}=useAuth();const navigate=useNavigate();const detectInputType=input=>{const emailRegex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;const phoneRegex=/^[\\+]?[1-9][\\d]{3,14}$/;if(emailRegex.test(input))return'email';if(phoneRegex.test(input.replace(/\\s/g,'')))return'phone';return'unknown';};const handleSendOTP=async e=>{e.preventDefault();if(!identifier.trim()){toast.error('Please enter your phone number or email');return;}const inputType=detectInputType(identifier);if(inputType==='unknown'){toast.error('Please enter a valid phone number or email address');return;}setLoading(true);const result=await sendOTP(identifier);setLoading(false);if(result.success){setOtpSent(true);toast.success('OTP sent successfully!');}else{toast.error(result.error);}};const handleLogin=async e=>{e.preventDefault();if(!otp.trim()){toast.error('Please enter the OTP');return;}setLoading(true);const result=await login(identifier,otp);setLoading(false);if(result.success){toast.success('Login successful!');navigate('/dashboard');}else{toast.error(result.error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gradient-to-br from-primary to-secondary flex items-center justify-center px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md w-full bg-white rounded-lg shadow-xl p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-primary mb-2\",children:\"Tradex\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Professional Trading Platform\"})]}),!otpSent?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendOTP,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Phone Number or Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:identifier,onChange:e=>setIdentifier(e.target.value),placeholder:\"Enter your phone or email\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all\",required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"We'll automatically detect if it's a phone number or email\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"w-full bg-accent hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50\",children:loading?'Sending...':'Send OTP'})]}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Enter OTP\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:otp,onChange:e=>setOtp(e.target.value),placeholder:\"Enter 6-digit OTP\",className:\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-center text-lg tracking-widest\",maxLength:\"6\",required:true}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[\"OTP sent to \",identifier]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"w-full bg-accent hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50\",children:loading?'Verifying...':'Login'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setOtpSent(false);setOtp('');},className:\"w-full text-gray-600 hover:text-gray-800 text-sm\",children:\"\\u2190 Back to enter phone/email\"})]})]})});};export default Login;","map":{"version":3,"names":["React","useState","useNavigate","useAuth","toast","jsx","_jsx","jsxs","_jsxs","Login","identifier","setIdentifier","otp","setOtp","otpSent","setOtpSent","loading","setLoading","login","sendOTP","navigate","detectInputType","input","emailRegex","phoneRegex","test","replace","handleSendOTP","e","preventDefault","trim","error","inputType","result","success","handleLogin","className","children","onSubmit","type","value","onChange","target","placeholder","required","disabled","maxLength","onClick"],"sources":["/workspaces/tradex/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../components/AuthContext';\nimport toast from 'react-hot-toast';\n\nconst Login = () => {\n  const [identifier, setIdentifier] = useState('');\n  const [otp, setOtp] = useState('');\n  const [otpSent, setOtpSent] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const { login, sendOTP } = useAuth();\n  const navigate = useNavigate();\n\n  const detectInputType = (input) => {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    const phoneRegex = /^[\\+]?[1-9][\\d]{3,14}$/;\n    \n    if (emailRegex.test(input)) return 'email';\n    if (phoneRegex.test(input.replace(/\\s/g, ''))) return 'phone';\n    return 'unknown';\n  };\n\n  const handleSendOTP = async (e) => {\n    e.preventDefault();\n    if (!identifier.trim()) {\n      toast.error('Please enter your phone number or email');\n      return;\n    }\n\n    const inputType = detectInputType(identifier);\n    if (inputType === 'unknown') {\n      toast.error('Please enter a valid phone number or email address');\n      return;\n    }\n\n    setLoading(true);\n    const result = await sendOTP(identifier);\n    setLoading(false);\n\n    if (result.success) {\n      setOtpSent(true);\n      toast.success('OTP sent successfully!');\n    } else {\n      toast.error(result.error);\n    }\n  };\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    if (!otp.trim()) {\n      toast.error('Please enter the OTP');\n      return;\n    }\n\n    setLoading(true);\n    const result = await login(identifier, otp);\n    setLoading(false);\n\n    if (result.success) {\n      toast.success('Login successful!');\n      navigate('/dashboard');\n    } else {\n      toast.error(result.error);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-primary to-secondary flex items-center justify-center px-4\">\n      <div className=\"max-w-md w-full bg-white rounded-lg shadow-xl p-8\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-3xl font-bold text-primary mb-2\">Tradex</h1>\n          <p className=\"text-gray-600\">Professional Trading Platform</p>\n        </div>\n\n        {!otpSent ? (\n          <form onSubmit={handleSendOTP} className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Phone Number or Email\n              </label>\n              <input\n                type=\"text\"\n                value={identifier}\n                onChange={(e) => setIdentifier(e.target.value)}\n                placeholder=\"Enter your phone or email\"\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all\"\n                required\n              />\n              <p className=\"text-xs text-gray-500 mt-1\">\n                We'll automatically detect if it's a phone number or email\n              </p>\n            </div>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-accent hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50\"\n            >\n              {loading ? 'Sending...' : 'Send OTP'}\n            </button>\n          </form>\n        ) : (\n          <form onSubmit={handleLogin} className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Enter OTP\n              </label>\n              <input\n                type=\"text\"\n                value={otp}\n                onChange={(e) => setOtp(e.target.value)}\n                placeholder=\"Enter 6-digit OTP\"\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all text-center text-lg tracking-widest\"\n                maxLength=\"6\"\n                required\n              />\n              <p className=\"text-xs text-gray-500 mt-1\">\n                OTP sent to {identifier}\n              </p>\n            </div>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"w-full bg-accent hover:bg-green-600 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50\"\n            >\n              {loading ? 'Verifying...' : 'Login'}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setOtpSent(false);\n                setOtp('');\n              }}\n              className=\"w-full text-gray-600 hover:text-gray-800 text-sm\"\n            >\n              ‚Üê Back to enter phone/email\n            </button>\n          </form>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}